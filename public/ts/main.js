(()=>{const A=function(a){return new Promise(b=>{var c=document.createElement("script");c.src=a,c.onload=()=>{b()},document.head.appendChild(c)})},B=function(a){return new Promise(b=>{var c=document.createElement("link");c.href=a,c.type="text/css",c.rel="stylesheet",c.onload=()=>{b()},document.head.appendChild(c)})};var M=function(a){for(var b=function(g){for(var f=g.childNodes,e=f.length,m=[],h,p,j,k,l=0;l<e;l++){h=f[l];if(h.nodeType!==1)continue;p=h.children[0],j=p.getAttribute("data-size").split("x"),k={src:p.getAttribute("href"),w:parseInt(j[0],10),h:parseInt(j[1],10)},h.children.length>1&&(k.title=h.children[1].innerHTML),p.children.length>0&&(k.msrc=p.children[0].getAttribute("src")),k.el=h,m.push(k)}return m},c=function g(f,e){return f&&(e(f)?f:g(f.parentNode,e))},d=function(g){g=g||window.event,g.preventDefault?g.preventDefault():g.returnValue=!1;var f=g.target||g.srcElement,e=c(f,function(u){return u.tagName&&u.tagName.toUpperCase()==="FIGURE"});if(!e)return;for(var m=e.parentNode,h=e.parentNode.childNodes,p=h.length,j=0,k,l=0;l<p;l++){if(h[l].nodeType!==1)continue;if(h[l]===e){k=j;break}j++}return k>=0&&n(k,m),!1},i=function(){var g=window.location.hash.substring(1),f={};if(g.length<5)return f;for(var e=g.split("&"),m=0;m<e.length;m++){if(!e[m])continue;var h=e[m].split("=");if(h.length<2)continue;f[h[0]]=h[1]}return f.gid&&(f.gid=parseInt(f.gid,10)),f},n=function(g,f,e,m){var h=document.querySelectorAll(".pswp")[0],p,j,k;k=b(f),j={galleryUID:f.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(u){var R=k[u].el.getElementsByTagName("img")[0],S=window.pageYOffset||document.documentElement.scrollTop,D=R.getBoundingClientRect();return{x:D.left,y:D.top+S,w:D.width}}};if(m)if(j.galleryPIDs){for(var l=0;l<k.length;l++)if(k[l].pid==g){j.index=l;break}}else j.index=parseInt(g,10)-1;else j.index=parseInt(g,10);if(isNaN(j.index))return;e&&(j.showAnimationDuration=0),p=new PhotoSwipe(h,PhotoSwipeUI_Default,k,j),p.init()},o=document.querySelectorAll(a),q=0,C=o.length;q<C;q++)o[q].setAttribute("data-pswp-uid",q+1),o[q].onclick=d;var s=i();s.pid&&s.gid&&n(s.pid,o[s.gid-1],!0,!0)};function H(a){let b=document.createElement("div");b.className="gallery";let c=a[0].parentNode,d=a[0];c.insertBefore(b,d);for(let i=0;i<a.length;++i){const n=a[i].querySelector("img").width,o=a[i].querySelector("img").height;a[i].style.flexGrow=`${n*100/o}`,a[i].style.flexBasis=`${n*240/o}px`,b.appendChild(a[i])}}function N(){const a=[A("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"),A("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"),B("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"),B("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css")];return Promise.all(a)}function I(a){const b=document.querySelector(a).querySelectorAll("figure");if(b.length){let c=[b[0]];for(let d=1;d<b.length;++d)b[d].previousElementSibling===c[c.length-1]?c.push(b[d]):(H(c),c=[b[d]]);c.length>0&&H(c),N().then(()=>{const d=document.querySelector(".pswp");d.style.removeProperty("display"),M(`${a} .gallery`)})}}let r={};if(localStorage.hasOwnProperty("StackColorsCache"))try{r=JSON.parse(localStorage.getItem("StackColorsCache"))}catch(a){r={}}async function v(a,b,c){if(!a)return await Vibrant.from(c).getPalette();if(!r.hasOwnProperty(a)||r[a].hash!==b){const d=await Vibrant.from(c).getPalette();r[a]={hash:b,Vibrant:{hex:d.Vibrant.hex,rgb:d.Vibrant.rgb,bodyTextColor:d.Vibrant.bodyTextColor},DarkMuted:{hex:d.DarkMuted.hex,rgb:d.DarkMuted.rgb,bodyTextColor:d.DarkMuted.bodyTextColor}},localStorage.setItem("StackColorsCache",JSON.stringify(r))}return r[a]}let O=(a,b=500)=>{a.classList.add("transiting"),a.style.transitionProperty="height, margin, padding",a.style.transitionDuration=b+"ms",a.style.height=a.offsetHeight+"px",a.offsetHeight,a.style.overflow="hidden",a.style.height="0",a.style.paddingTop="0",a.style.paddingBottom="0",a.style.marginTop="0",a.style.marginBottom="0",window.setTimeout(()=>{a.classList.remove("show"),a.style.removeProperty("height"),a.style.removeProperty("padding-top"),a.style.removeProperty("padding-bottom"),a.style.removeProperty("margin-top"),a.style.removeProperty("margin-bottom"),a.style.removeProperty("overflow"),a.style.removeProperty("transition-duration"),a.style.removeProperty("transition-property"),a.classList.remove("transiting")},b)},P=(a,b=500)=>{a.classList.add("transiting"),a.style.removeProperty("display"),a.classList.add("show");let c=a.offsetHeight;a.style.overflow="hidden",a.style.height="0",a.style.paddingTop="0",a.style.paddingBottom="0",a.style.marginTop="0",a.style.marginBottom="0",a.offsetHeight,a.style.transitionProperty="height, margin, padding",a.style.transitionDuration=b+"ms",a.style.height=c+"px",a.style.removeProperty("padding-top"),a.style.removeProperty("padding-bottom"),a.style.removeProperty("margin-top"),a.style.removeProperty("margin-bottom"),window.setTimeout(()=>{a.style.removeProperty("height"),a.style.removeProperty("overflow"),a.style.removeProperty("transition-duration"),a.style.removeProperty("transition-property"),a.classList.remove("transiting")},b)},Q=(a,b=500)=>window.getComputedStyle(a).display==="none"?P(a,b):O(a,b);function J(){const a=document.getElementById("toggle-menu");a&&a.addEventListener("click",()=>{if(document.getElementById("main-menu").classList.contains("transiting"))return;document.body.classList.toggle("show-menu"),Q(document.getElementById("main-menu"),300),a.classList.toggle("is-active")})}const E="StackColorScheme",w=window.matchMedia("(prefers-color-scheme: dark)"),x=document.getElementById("schemeSelect"),L=()=>window.matchMedia("(prefers-color-scheme: dark)").matches===!0,F=a=>{localStorage.setItem(E,a)},y=()=>localStorage.getItem(E),t=a=>{a==="auto"?L()?document.body.dataset.scheme="dark":document.body.dataset.scheme="light":document.body.dataset.scheme=a},z=a=>{t("auto")};var G=()=>{document.body.style.setProperty("transition","background-color .3s ease"),y()?t(y()):(t("auto"),F("auto"),w.addEventListener("change",z)),x.value=y(),x.addEventListener("change",a=>{const b=x.value;t(b),F(b),b==="auto"?w.addEventListener("change",z):w.removeEventListener("change",z)})};let K={init:()=>{G(),J(),document.querySelector(".article-content")&&I(".article-content"),document.querySelectorAll(".color-tag").forEach(async b=>{const c=b.getAttribute("data-image"),d=b.getAttribute("data-key"),i=b.getAttribute("data-hash"),n=await v(d,i,c);b.style.color=n.Vibrant.bodyTextColor,b.style.background=n.Vibrant.hex});const a=document.querySelector(".article-list--tile");if(a){let b=new IntersectionObserver(async(c,d)=>{c.forEach(i=>{if(!i.isIntersecting)return;d.unobserve(i.target);const n=i.target.querySelectorAll("article.has-image");n.forEach(async o=>{const q=o.querySelector("img"),C=q.src,s=q.getAttribute("data-key"),g=q.getAttribute("data-hash"),f=o.querySelector(".article-details"),e=await v(s,g,C);f.style.background=`
                        linear-gradient(0deg,
                            rgba(${e.DarkMuted.rgb[0]}, ${e.DarkMuted.rgb[1]}, ${e.DarkMuted.rgb[2]}, 0.5) 0%,
                            rgba(${e.Vibrant.rgb[0]}, ${e.Vibrant.rgb[1]}, ${e.Vibrant.rgb[2]}, 0.75) 100%)`})})});b.observe(a)}}};window.addEventListener("load",()=>{setTimeout(function(){K.init()},0)});window.Stack=K;})();
/*!
*   Hugo Theme Stack
*
*   @author: Jimmy Cai
*   @website: https://jimmycai.com
*   @link: https://github.com/CaiJimmy/hugo-theme-stack
*/
